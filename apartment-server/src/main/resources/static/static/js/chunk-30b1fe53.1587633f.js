(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-30b1fe53"],{"0adb":function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"f",function(){return r}),n.d(t,"g",function(){return s}),n.d(t,"b",function(){return o}),n.d(t,"e",function(){return l}),n.d(t,"d",function(){return c}),n.d(t,"a",function(){return u});var a=n("b775");function i(e){return Object(a["a"])({url:"/repairs/repairsList",method:"post",data:e,headers:{"Content-Type":"application/json"}})}function r(){return Object(a["a"])({url:"/repairs/selectStatusList",method:"get"})}function s(e){return Object(a["a"])({url:"/repairs/updateRepair",method:"post",data:e,headers:{"Content-Type":"application/json"}})}function o(e){return Object(a["a"])({url:"/file/delImage/"+e,method:"get"})}function l(e){return Object(a["a"])({url:"/file/getImages/"+e,method:"get"})}function c(){return Object(a["a"])({url:"/file/getHostAddress",method:"get"})}function u(e){return Object(a["a"])({url:"/repairs/insertRepairAndFile",method:"post",data:e,headers:{"Content-Type":"application/json"}})}},3400:function(e,t,n){},6724:function(e,t,n){"use strict";n("8d41");var a="@@wavesContext";function i(e,t){function n(n){var a=Object.assign({},t.value),i=Object.assign({ele:e,type:"hit",color:"rgba(0, 0, 0, 0.15)"},a),r=i.ele;if(r){r.style.position="relative",r.style.overflow="hidden";var s=r.getBoundingClientRect(),o=r.querySelector(".waves-ripple");switch(o?o.className="waves-ripple":(o=document.createElement("span"),o.className="waves-ripple",o.style.height=o.style.width=Math.max(s.width,s.height)+"px",r.appendChild(o)),i.type){case"center":o.style.top=s.height/2-o.offsetHeight/2+"px",o.style.left=s.width/2-o.offsetWidth/2+"px";break;default:o.style.top=(n.pageY-s.top-o.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",o.style.left=(n.pageX-s.left-o.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return o.style.backgroundColor=i.color,o.className="waves-ripple z-active",!1}}return e[a]?e[a].removeHandle=n:e[a]={removeHandle:n},n}var r={bind:function(e,t){e.addEventListener("click",i(e,t),!1)},update:function(e,t){e.removeEventListener("click",e[a].removeHandle,!1),e.addEventListener("click",i(e,t),!1)},unbind:function(e){e.removeEventListener("click",e[a].removeHandle,!1),e[a]=null,delete e[a]}},s=function(e){e.directive("waves",r)};window.Vue&&(window.waves=r,Vue.use(s)),r.install=s;t["a"]=r},"7a07":function(e,t,n){"use strict";n.d(t,"f",function(){return i}),n.d(t,"h",function(){return r}),n.d(t,"e",function(){return s}),n.d(t,"g",function(){return o}),n.d(t,"c",function(){return l}),n.d(t,"i",function(){return c}),n.d(t,"d",function(){return u}),n.d(t,"b",function(){return d}),n.d(t,"a",function(){return p});var a=n("b775");function i(e){return Object(a["a"])({url:"/apartment/apartmentList",method:"post",data:e,headers:{"Content-Type":"application/json"}})}function r(){return Object(a["a"])({url:"/apartment/selectPattern",method:"get"})}function s(){return Object(a["a"])({url:"/apartment/selectFaceList",method:"get"})}function o(){return Object(a["a"])({url:"/apartment/selectHouseType",method:"get"})}function l(e){return Object(a["a"])({url:"/apartment/createApartment",method:"post",data:e,headers:{"Content-Type":"application/json"}})}function c(e){return Object(a["a"])({url:"/apartment/updateApartment",method:"post",data:e,headers:{"Content-Type":"application/json"}})}function u(e){return Object(a["a"])({url:"/apartment/deleteApartment",method:"post",data:e,headers:{"Content-Type":"application/json"}})}function d(e){return Object(a["a"])({url:"/apartment/getApartmentListByUserid/"+e,method:"get"})}function p(e){return Object(a["a"])({url:"/apartment/getApartmentById/"+e,method:"get"})}},"8d41":function(e,t,n){},b9bd:function(e,t,n){"use strict";var a=n("3400"),i=n.n(a);i.a},e684:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("el-steps",{attrs:{active:e.stepActive,simple:""}},[n("el-step",{attrs:{title:"公寓",icon:"el-icon-edit"}}),e._v(" "),n("el-step",{attrs:{title:"描述",icon:"el-icon-upload"}}),e._v(" "),n("el-step",{attrs:{title:"图片",icon:"el-icon-picture"}})],1),e._v(" "),n("div",{staticClass:"checkApartmentDescPic"},[[n("div",{staticClass:"add-container"},[n("el-form",{ref:"dataForm",staticStyle:{"margin-top":"30px"},attrs:{rules:e.rules,model:e.repairInfo,"label-position":"left"}},[n("el-form-item",{attrs:{label:"选择公寓地址",prop:"apartmentAddress"}},[null!=e.apartmentList?n("el-table",{staticStyle:{width:"100%","margin-top":"30px"},attrs:{data:e.apartmentList,border:"",fit:"","highlight-current-row":""},on:{"current-change":e.handleCurrentChange}},[n("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[n("el-form-item",{attrs:{label:"户型"}},[n("span",[e._v(e._s(t.row.houseType))])]),e._v(" "),n("el-form-item",{attrs:{label:"面积"}},[n("span",[e._v(e._s(t.row.roomArea)+"m²")])]),e._v(" "),n("el-form-item",{attrs:{label:"朝向"}},[n("el-tag",{attrs:{type:"success","close-transition":""}},[e._v(e._s(t.row.face))])],1),e._v(" "),n("el-form-item",{attrs:{label:"支付模式"}},[n("el-tag",{attrs:{type:"success","close-transition":""}},[e._v(e._s(t.row.pattern))])],1),e._v(" "),n("el-form-item",{attrs:{label:"地址"}},[n("span",[e._v(e._s(t.row.address))])])],1)]}}],null,!1,491257571)}),e._v(" "),n("el-table-column",{attrs:{type:"index",width:"50",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{prop:"address",label:"公寓地址"}})],1):e._e()],1),e._v(" "),n("el-form-item",{attrs:{label:"填写报修内容",prop:"content"}},[n("el-input",{attrs:{disabled:e.stepActive<1,type:"textarea",autosize:{minRows:5,maxRows:10},placeholder:"请输入报修内容"},model:{value:e.contentText,callback:function(t){e.contentText=t},expression:"contentText"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"选择上传报修图片描述",prop:"fileListSave"}},[n("el-upload",{ref:"uploadPic",staticClass:"upload-demo",staticStyle:{"margin-top":"40px","margin-down":"30px","margin-left":"0px"},attrs:{action:e.uploadUrl,headers:e.headersToken,data:e.fileFinalParams,limit:6,"on-exceed":e.checkLimit,"on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove,"on-change":e.handlePictureChange,"on-error":e.handlePictureError,"on-success":e.handlePictureSuccess,multiple:!0,"file-list":e.fileList,"auto-upload":e.autoUpload,"before-upload":e.beforeAvatarUpload,disabled:2!=e.stepActive,accept:"image/png, image/jpeg, image/gif, image/jpg","list-type":"picture-card"}},[n("i",{staticClass:"el-icon-plus"}),e._v(" "),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过6张图片")])])],1)],1),e._v(" "),n("el-button",{directives:[{name:"waves",rawName:"v-waves"},{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.loading,expression:"loading",modifiers:{fullscreen:!0,lock:!0}}],staticStyle:{width:"100%","margin-bottom":"30px"},attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.pushRepairInfo(t)}}},[e._v("提交")])],1)]],2),e._v(" "),n("el-dialog",{attrs:{visible:e.showCard,width:"100%",height:"100%"},on:{"update:visible":function(t){e.showCard=t}}},[n("img",{attrs:{width:"100%",src:e.imageUrl,alt:""}})])],1)},i=[],r=(n("34ef"),n("28a5"),n("ac4d"),n("8a81"),n("ac6a"),n("7f7f"),n("96cf"),n("3b8d")),s=n("db72"),o=n("2f62"),l=n("7a07"),c=n("6724"),u=n("0adb"),d={directives:{waves:c["a"]},data:function(){return{uploadUrl:"",autoUpload:!0,submitClick:!1,showCard:!1,stepActive:0,apartmentList:null,listLoading:!1,loading:!1,contentText:"",repairInfo:{userid:null,username:null,apartmentid:null,apartmentAddress:null,content:null,fileListSave:[]},rules:{content:[{required:!0,message:"报修内容必填",trigger:"blur"}],apartmentAddress:[{required:!0,message:"公寓地址必须选择",trigger:"blur"}]},fileInfo:{userid:null,username:null,resource:null,filename:null,fileType:null},fileList:[],passwordType:"password",imageUrl:"",imageKey:"",fileT:null,height:null,width:null}},computed:Object(s["a"])({},Object(o["b"])(["name","id","token"]),{headersToken:function(){return{Authorization:this.token}},fileFinalParams:function(){return null!==this.fileT?{files:this.fileT}:{}}}),watch:{contentText:function(e,t){0!==e.length?this.stepActive=2:this.stepActive=1,this.repairInfo.content=e}},created:function(){this.getHostAddress(),this.getApartmentList()},methods:{getHostAddress:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["d"])().then(function(e){t.uploadUrl=e.data});case 2:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}(),getApartmentList:function(){var e=this;this.repairInfo.userid=this.id,this.repairInfo.username=this.name,this.listLoading=!0,Object(l["b"])(this.id).then(function(t){console.log(t),e.apartmentList=t.data,e.listLoading=!1})},handleApartment:function(){this.fileList},handleCurrentChange:function(e){this.repairInfo.apartmentid=e.id,this.repairInfo.apartmentAddress=e.address,this.stepActive=1},resetRepairInfo:function(){this.repairInfo={userid:null,username:null,apartmentid:null,apartmentAddress:null,content:null}},pushRepairInfo:function(){var e=this;this.$refs["dataForm"].validate(function(t){if(!t)return e.loading=!1,e.$message({type:"warning",message:"请检查必填项！"}),!1;0===e.fileList.length||e.submitClick?(e.loading=!0,e.fileList.length===e.repairInfo.fileListSave.length&&Object(u["a"])(e.repairInfo).then(function(t){t.data?(e.resetRepairInfo(),e.repairInfo.fileListSave=[],e.contentText="",e.$refs.uploadPic.clearFiles(),e.loading=!1,e.$message({type:"success",message:"报修成功"})):e.$confirm("保修单提交失败，是否重试?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.pushRepairInfo(),e.loading=!1}).catch(function(){e.loading=!1,e.$message({type:"info",message:"已取消"})})}).catch(function(){e.$confirm("保修单提交失败，是否重试?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.pushRepairInfo(),e.loading=!1}).catch(function(){e.loading=!1,e.$message({type:"info",message:"已取消"})}),e.loading=!1})):e.$message({type:"info",message:"请等待上传完成后，再提交！"})})},inited:function(e){this.$viewer=e},handleRemove:function(e,t){var n=this;this.fileList=t,Object(u["b"])(e.response.data.filename).then(function(t){var a=!0,i=!1,r=void 0;try{for(var s,o=n.repairInfo.fileListSave[Symbol.iterator]();!(a=(s=o.next()).done);a=!0){var l=s.value;if(l.name===e.name){var c=n.repairInfo.fileListSave.indexOf(l);n.repairInfo.fileListSave.splice(c,1);break}}}catch(u){i=!0,r=u}finally{try{a||null==o.return||o.return()}finally{if(i)throw r}}})},handlePictureCardPreview:function(e){this.imageKey=e.name,this.imageUrl=e.url,this.showCard=!0},handlePictureChange:function(e,t){this.fileList=t},checkLimit:function(e,t){6===t.length&&this.$message.error("上传图片不可超过 6 个!")},handlePictureError:function(e,t,n){this.$message.error(e)},handlePictureSuccess:function(e,t,n){"true"===e.message&&(t.name=e.data.name,this.fileInfo={userid:this.repairInfo.userid,username:this.repairInfo.username,filename:e.data.filename,resource:e.data.resource,fileType:e.data.suffix},this.repairInfo.fileListSave.push(this.fileInfo)),this.fileList.length===this.repairInfo.fileListSave.length&&(this.submitClick=!0)},beforeAvatarUpload:function(e){var t=e.type.indexOf("image")>=0;if(!t)return this.$message.error("上传图片的格式不正确!"),!1;var n=e.size/1024/1024,a=.18;n>20?a=.15:n>10&&n<20?a=.16:n>5&&n<10&&(a=.17);var i=this;return n>1?new Promise(function(t){var n=new FileReader,r=new Image;r.onload=function(n){var s=document.createElement("canvas"),o=s.getContext("2d"),l=r.width*a,c=r.height*a;i.imgWidthHeight="".concat(l,"/").concat(c),s.width=l,s.height=c,o.clearRect(0,0,l,c),o.drawImage(r,0,0,l,c);var u=s.toDataURL(e.type),d=i.dataURItoBlob(u,e.type);t(d)},n.onload=function(e){r.src=e.target.result},n.readAsDataURL(e)}):new Promise(function(t){var n=new FileReader,a=new Image;a.onload=function(e){var n=a.width,r=a.height;i.imgWidthHeight="".concat(n,"/").concat(r),t()},n.onload=function(e){a.src=e.target.result},n.readAsDataURL(e)})},dataURItoBlob:function(e,t){for(var n=atob(e.split(",")[1]),a=[],i=0;i<n.length;i++)a.push(n.charCodeAt(i));return new Blob([new Uint8Array(a)],{type:t})}}},p=d,f=(n("b9bd"),n("2877")),m=Object(f["a"])(p,a,i,!1,null,null,null);t["default"]=m.exports}}]);